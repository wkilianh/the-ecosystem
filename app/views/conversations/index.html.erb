<div data-controller="conversation">
  <div class="wrapper">
    <!-- Sidebar -->
    <nav id="sidebar">
      <div class="sidebar-header">
        <h3>Conversations</h3>
      </div>
      <% if @conversations.count > 0 %>

        <ul class="list-unstyled components">
            <% @conversations.each do |conversation| %>
              <% if conversation.sender == current_user %>
                    <li data-action="click->conversation#refresh" data-id="<%= conversation.id %>"  >
                        <%= link_to conversation.receiver.nickname, conversation_path(conversation), remote: true%>
                    </li>
              <% else %>
                <li data-action="click->conversation#refresh" data-id="<%= conversation.id %>">
                    <%= link_to conversation.sender.nickname, conversation_path(conversation), remote: true %>
                </li>
              <% end %>
            <% end %>
        </ul>

      <% end %>
    </nav>
    <div id="username" type="hidden" value="<%= current_user.nickname %>"></div>
    <div class="chat">
      <% if @conversations.count > 0 %>

          <div class="conversation" data-conversation-target="conversationcon">
            
          </div>

          <span class="sendfield" id="chat-text" style="width: 800px;" data-conversation-target="sendcon">
           
          </span>
      <% else %>
        <div><h4>You dont have any conversations yet.</h4></div>
      <% end %>
    </div>
  </div>
</div>

<script>
  function clearText() {
    var sentMsg = document.querySelector('.form-control')
    if (sentMsg){
      sentMsg.addEventListener('keyup', function (e) {
        if (e.key === 'Enter') {
          sentMsg.value = ""
        }
      });
    }
  }
  
  document.addEventListener('change', (event) => {
  clearText()
});
</script>